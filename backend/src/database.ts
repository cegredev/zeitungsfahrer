import mysql from "mysql2/promise";
import fs from "fs/promises";
import logger from "./logger.js";

const connectionData = await fs.readFile("env.json", "utf8");

const connection = await mysql.createConnection({
	...JSON.parse(connectionData),
	multipleStatements: true,
});

export interface RouteReport {
	code: number;
	body?: string;
}

try {
	await connection.connect();
	logger.info("MySql connection successful");
} catch (e) {
	logger.error("MySql connection failed", e);
}

export default connection;
